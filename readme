readme file for Dataset THBI_SWUS_Vs

This repository contains the shear wavespeed (Vs) model and other major products associated with the manuscript "A New View of Shear Wavespeed and the Lithosphere-Asthenosphere Boundary in the Southwestern United States," currently in revision in the Journal of Geophysical Research: Solid Earth. In this paper, we have implemented a Transdimensional Hierarchical Bayesian Inversion of seismic data from converted body waves and from surfaces waves to generate a suite of 1-D models of Vs at 599 locations in the crust and upper mantle below the Southwestern United States. 

The items in this repository include:

1) File mdls_SWUS.mat - this contains collated results from the inversion of seismic data. These models summarize information from the posterior distribution, but do not contain every single model. File contents are described below.

2) Interpolated Vs model files, for regularly-gridded files in .txt format. This includes File Vs.txt, Vs_sigma1_max.txt, Vs_sigma1_min.txt, Vs_sigma2_max.txt, Vs_sigma2_min.txt which are the median Vs model, one standard deviation above and below the median, and two standard deviations above and below the median, respectively. Files Lat.txt and Lon.txt contain the profile latitude and longitude coordinates, indexed to correspond to the Vs and Vs_sigma rows.

3) Posterior distributions - that is, the full distribution of model parameters from all accepted models of the Markov Chain Monte Carlo inversion - for six locations are included as examples. The posterior distributions from other sites are available on request from the authors.

4) Script GetGradients.m - the script to extract velocity gradient information from the data file mdls_SWUS.mat, i.e. locations of the Moho boundary and negative and positive changes in Vs with depth. The negative velocity gradients are further categorized into Lithosphere-Asthenosphere Boundary (LAB) and Mid-Lithospheric Discontinuity (MLD) identifications when possible.

5) File Gradients_all.mat - a Matlab data file, generated by GetGradients.m, containing depths and Vs of gradients and several other parameters that are important for plotting. Further information on the variables contained within this file can be found below.

6) Plotting scripts for generating plots within the paper using Matlab - these include Error_and_uncertainty_maps.m, PlotGradients_main.m (for plots based on Vs gradient information), PlotGradients_SI.m (for plots based on Vs gradient information in the Supporting Information), PlotStationResults.m (for plots of model results from a single station), and PlotSlices.m (for plotting vertical slices through the Vs model). Each script references the specific figure numbers in the paper. Some scripts require additional Matlab packages, and URLs for download are listed within the script comments.

7) Subdirectories data and functions contain additional functions for plotting, and accessory information including volcano locations from NAVDAT.org, and tectonic boundaries from the USGS physiographic provinces dataset (https://data.usgs.gov/datacatalog/data/USGS:e04ea9e9-17b6-45ae-b279-7bc35ea79539).



Contact: 
Eva Golos 
University of Wisconsin - Madison
golos@wisc.edu



---- 
Format for mdls_SWUS.mat

This file is a Matlab structure with the following fields:

1) lat - Latitude of each inversion location

2) lon - Longitude of each inversion location

3) model - The model parameters, contained within a substructure for each location, that summarize the posterior suite distributions.
For instance, mdls.model{1} contains [size of variable in brackets] (descriptions in parentheses):

        vpvsav: 1.7017 (Median Vp/Vs in crust)
    vpvsminmax: [2×1 double] (Minimum and maximum Vp/Vs in crust, defined as the quantiles containing 99.5% of points)
      vpvssig1: [2×1 double] (Vp/Vs of +/- one standard deviation)
      vpvssig2: [2×1 double] (Vp/Vs of +/- two standard deviations)
             Z: [234×1 double] (Depths contained in model)
          Vsav: [234×1 double] (Median Vs, at depths described in Z)
      Vsminmax: [234×2 double] (Minimum and maximum Vs)
        Vssig1: [234×2 double] (Vs at one standard deviation above and below median)
        Vssig2: [234×2 double] (Vs at two standard deviations above and below median)
    hyperparms: [1×1 struct] (structure with hyperparameter information)
    				sig_RF_Sp_CCP: mu_log10 (expected value) and sigma_log10 (standard deviation) of log-normal fit to data error for CCP stack data
    				sig_SW_Ray_phV: mu_log10 (expected value) and sigma_log10 (standard deviation) of log-normal fit to data error for surface wave phase velocity data
            Zd: [1×2 struct] (structure with information on model discontinuity parameters)
            		mu(1), std(1) (median and standard deviation of depth of sediment-base layer; 0 in our study)
            		mu(2), std(2) (median and standard deviation of depth of Moho boundary)

Note 1: The variables labeled "ave" are usually median. Assuming the distribution is close enough to Gaussian, the median and mean are coincident.
Note 2: The term "sigma" is used to describe uncertainty of the posterior distribution as well as the hyperparameters of inversion.

4) misfit - data structure describing misfit metrics. Each field has an entry for CCP stack data (RF_Sp_CCP), and surface wave data (SW_Ray_phV). Fields are:
		E2: Sum of squared misfits, i.e. the e value as defined in paper
		chi2: chi-square value, i.e. E2/(sigma^2)
		rms: RMS misfit, i.e. sqrt(E2)/N
		chi2sum: sum of chi2 values over all data.


----
Format for Gradients_all.mat

This .mat file contains variables depicting Vs gradients in the crust and upper mantle inferred from the models contained in mdls_SWUS.mat. Variable names should be self-explanatory, but here are some hints:
Moho_Z - depth of Moho discontinuity
NVG1_Z, NVG1_Vs - depth and Vs in the center of the shallowest Negative Velocity Gradient (NVG) detected. If there is only one NVG in the corresponding profile, it is listed here.
NVG1_Z_bottom, NVG1_Vs_bottom - Vs and NVG at the base of the NVG, i.e. usually the minimum sub-lithospheric Vs
NVG2_Z, NVG2_Vs - depth and Vs in the center of the deeper Negative Velocity Gradient (NVG) detected. If only one NVG, this value is zero.
is1a - Indicates high Reliability. If logical true, the corresponding value of NVG1_Z is likely to represent the LAB.
PVG_Z, PVG_Z_top, PVG_Z_bottom, etc. - center, top, and bottom of the sub-LAB Positive Velocity Gradient (PVG)
isPVG_amp - if logical true, amplitude of Vs contrast at the PVG has been calculated.
LAB_Z, LAB_Vs, LAB_width, etc - center depth, Vs, vertical width of gradient interpreted as Lithosphere-Asthenosphere Boundary (LAB). If no interpretation made, this value is zero.
shallow_is_LAB - indicates that NVG1 is the LAB.
deep_is_LAB - indicates that NVG2 is the LAB.
MLD_Z, MLD_Vs, MLD_width, etc - center depth, Vs, vertical width of the interface interpreted as Mid-Lithospheric Discontinuity (MLD). If no interpretation made, this value is zero.





